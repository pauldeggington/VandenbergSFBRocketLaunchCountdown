<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Launch T-time</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: black; /* Changed background color to black */
            color: white; /* Changed text color to white */
        }
        #launch-info {
          width: 100vw;
            text-align: center;
            margin-bottom: 20px;
        }
        #t-time {
            font-size: 8vw; /* Increased font size for time text */
            color: red; /* Changed time text color to red */
            background: black; /* Changed background color to black */
            padding: 20px;
            border-radius: 10px;
        }
        #launch-name {
          font-size: 3vw;
        }
    </style>
</head>
<body>
    <div id="launch-info">
        
        <div id="t-time">Loading...</div>
        <h2 id="launch-name">Loading...</h2>
    </div>

    <script>
        async function fetchLaunchData() {
            const url = "https://fdo.rocketlaunch.live/json/launches/next/5";
            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                console.log('API Response:', data); // Log the entire response to inspect the structure
                const launches = data?.result?.filter(launch => launch.pad?.location?.name === 'Vandenberg SFB');
                if (!launches || launches.length === 0) {
                    throw new Error('No upcoming launches from Vandenberg SFB');
                }
                return launches[0];
            } catch (error) {
                console.error('Error fetching data:', error);
                document.getElementById('launch-info').innerHTML = `<p>Error loading launch data: ${error.message}</p>`;
            }
        }

        function calculateTTime(launchTime) {
            const currentTime = new Date();
            const launchDateTime = new Date(launchTime);
            console.log(`Launch Time: ${launchTime}, Parsed Launch Time: ${launchDateTime}`); // Log the times to debug
            const timeDiff = launchDateTime - currentTime;

            if (timeDiff <= 0) {
                return "T-0";
            }

            const days = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((timeDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);

            if (days > 0) {
                return `T-   ${days}d : ${hours}h : ${minutes}m : ${seconds}s`; // Added colons between days, hours, minutes, and seconds
            } else {
                return `T-   ${hours}h : ${minutes}m : ${seconds}s`; // Added colons between hours, minutes, and seconds
            }
        }

        async function displayTTime() {
            try {
                const launch = await fetchLaunchData();
                console.log('Launch Object:', launch); // Log the launch object to inspect its structure
                const launchName = launch.name || 'Unnamed Launch';
                const spaceAgency = launch.provider?.name || 'Unknown Agency';
                document.getElementById('launch-name').innerText = `${launchName} - ${spaceAgency}`;
                const launchTime = launch.t0; // Use 't0' field for launch time
                setInterval(() => {
                    const tTime = calculateTTime(launchTime);
                    document.getElementById('t-time').innerText = tTime;
                }, 1000);
            } catch (error) {
                console.error('Error displaying launch data:', error);
            }
        }

        displayTTime();
    </script>
</body>
</html>
